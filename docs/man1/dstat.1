.\" Automatically generated by Pandoc 3.1.12.2
.\"
.TH "DSTAT" "1" "Mar 26 2024" "0.8.4\-pre\-release" "User Manual"
.SH NAME
dstat \- Quickly gather and print directory statistics.
.SH SYNOPSIS
\f[B]dstat\f[R] [\f[I]OPTION\f[R]]\&...
[\f[I]DIRECTORY\f[R]]\&...
.SH DESCRIPTION
\f[B]dstat\f[R] quickly gathers \[lq]directory statistics\[rq] on one or
more directories supplied at the command line.
It is most useful as a diagnostics and \[lq]sanity checking\[rq] tool in
BigData environments where file management can be unwieldy.
For example, trying to determine the number of files under a certain
directory with \f[B]ls\f[R](1) can take many minutes to complete when
there are millions of files to be counted.
\f[B]dstat\f[R], on the other hand, reads the directory inode blocks
directly, which can drastically reduce the amount of time, not to
mention disk I/O overhead, needed in order to help determine file
distribution.
.SH OPTIONS
.TP
\f[B][DIRECTORY]\f[R]
The path, relative or fully\-qualified, of zero or more directories on
which to collect statistics.
Statistics may differ by operating system or filesystem type but
generally include:
.RS
.PP
\f[CR]DT_REG\f[R] \- Regular file entires
.RE
.RS
.PP
\f[CR]DT_DIR\f[R] \- Sub\-directory entries
.RE
.RS
.PP
\f[CR]DT_LNK\f[R] \- Symbolic links
.RE
.RS
.PP
\f[CR]DT_CHR\f[R] \- Character\-special files
.RE
.RS
.PP
\f[CR]DT_BLK\f[R] \- Block\-special files
.RE
.PP
Filesystems that support BSD extensions may also show:
.RS
.PP
\f[CR]DT_SOCK\f[R] \- BSD Sockets
.RE
.RS
.PP
\f[CR]DT_FIFO\f[R] \- FIFO (pipe) files
.RE
.RS
.PP
\f[CR]DT_WHT\f[R] \- Union whiteout files
.RE
.PP
Any unknown file types (e.g not listed in \f[CR]sys/dirent.h\f[R]) will
be counted as \f[CR]DT_UNKNOWN\f[R], \[lq]unknown\[rq].
.PP
Multiple directories may be specified (see EXAMPLES).
If no directory is specified, the current working directory is assumed.
.TP
\f[B]\-C\f[R], \f[B]\[em]continuous\f[R]
Continuously update \f[CR]STDOUT\f[R] with statistical counts.
This helps you look busy whilst sipping at your coffee.
Implies \f[CR]\-L\f[R] / \f[CR]\-\-linear\f[R] output format.
Count updates are printed on a single line, updated inline, unless the
\f[CR]\-L\f[R] / \f[CR]\-\-linear\f[R] flag is explicitly called.
.TP
\f[B]\-L\f[R], \f[B]\[em]linear\f[R]
Rather than displaying a descriptive block of text with the stastical
data (the default output), show a header line followed by a single line
of all statistical data (see EXAMPLES).
When explicitly specified with the \f[CR]\-C\f[R] /
\f[CR]\-\-continuous\f[R] option, count updates are printed on new
lines.
.TP
\f[B]\-c\f[R], \f[B]\[em]csv\f[R]
Prints CSV\-formatted output.
With the \f[CR]\-o\f[R]/\f[CR]\-\-output\f[R] options (see below),
writes CSV output to the named output file.
Has no effect without \f[CR]\-o\f[R] flag if either \f[CR]\-C\f[R] or
\f[CR]\-L\f[R] flags are also specified.
.TP
\f[B]\-q\f[R], \f[B]\[em]quiet\f[R]
Do not print the directory list in default output (\[lq]block\[rq])
mode.
With \f[CR]\-c\f[R], \f[CR]\-C\f[R], and/or \f[CR]\-L\f[R] flags, only
prints the accumulated statistical counts without directory or header
lines.
.TP
\f[B]\-o\f[R], \f[B]\[em]outfile\f[R] [\f[I]OUTFILE\f[R]]
Send the default output to the named \f[CR][OUTFILE]\f[R].
Note that this flag may be used \f[I]in addition\f[R] to aforementioned
output format\- control flags; this implies opening \f[CR][OUTFILE]\f[R]
on start, final population of \f[CR][OUTFILE]\f[R] prior to termination,
and output to \f[CR]STDOUT\f[R] following the output format flags.
.TP
\f[B]\-l\f[R], \f[B]\[em]logfile\f[R] [\f[I]LOGFILE\f[R]]
Similar to the \f[CR]\-o\f[R] / \f[CR]\-\-outfile\f[R] flag, send error
data to the named \f[CR][LOGFILE]\f[R].
The main difference with specifying the \f[CR]\-l\f[R] /
\f[CR]\-\-logfile\f[R] option is that any directory/ies that are not
valid or cannot be examined (e.g because of permissions errors) are
simply logged to \f[CR][LOGFILE]\f[R] and program execution continues.
Normally, any directory access errors, along with all other errors, will
cause the program to halt.
.TP
\f[B]\-v\f[R], \f[B]\[em]version\f[R]
Prints the current software revision and exits.
.TP
\f[B]\-V\f[R], \f[B]\[em]Version\f[R]
Prints verbose software release information (including version tag, Git
commit ID, author, and date information) and exits.
.TP
\f[B]\-h\f[R], \f[B]\[em]help\f[R]
Display a short help message with usage information.
.SH EXAMPLES
.TP
\f[B]dstat\f[R]
Prints directory statistics for the current working directory.
.TP
\f[B]dstat \[em]continuous /data /bigdata\f[R]
Display combined stats for both the \f[CR]/data\f[R] and
\f[CR]/bigdata\f[R] filesystems, printing the output to a single line,
inline, as it becomes available.
.TP
\f[B]dstat \-C \-L \-q \-o /tmp/dstat.out \-l /tmp/dstat.log /data /bigdata | tee > /tmp/dsatat.csv\f[R]
Obviously, this one is a little more involved.
In short, monitor progress whilst saving state and not stopping on
errant directory names but dutifully logging such to the logfile (in
this case, \f[CR]/tmp/dstat.log\f[R]).
In particular, continuously follow the output (via \f[CR]STDOUT\f[R])
for scanning the \f[CR]/data\f[R] and \f[CR]/bigdata\f[R] directories.
Summary output is sent to an output file, here
\f[CR]/tmp/dstat.out\f[R].
.TP
\f[B]dstat \[em]linear \[em]csv \[em]outfile=/tmp/outfile.csv /bigdata\f[R]
Print statistics for the \f[CR]/bigdata\f[R] filesystem as a formatted
line to \f[CR]stdout\f[R] with the same information written to
\f[CR]/tmp/outfile.csv\f[R] in CSV format.
.TP
\f[B]dstat \[em]quiet \[em]csv \[em]outfile=/tmp/outfile.csv /bigdata\f[R]
Update the \f[CR]/tmp/outfile.csv\f[R] output file with the latest
statistics from the \f[CR]/bigdata\f[R] filesystem.
.TP
\f[B]dstat \[em]logfile=/dev/null /data /bigdata\f[R]
Print statistics on the \f[CR]/data\f[R] and \f[CR]/bigdata\f[R]
filesystems ignoring any non\- fatal errors.
.SH AUTHORS
Written by Walter G Davies, A Stranger Chronicle.
\c
.UR https://github.com/ASCCON/
.UE \c
.SH COPYRIGHT
\f[B]MIT License\f[R]
.PP
\f[I]Copyright (c) 2024 Walter G Davies, A Stranger Chronicle\f[R]
.PP
Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
\[lq]Software\[rq]), to deal in the Software without restriction,
including without limitation the rights to use, copy, modify, merge,
publish, distribute, sublicense, and/or sell copies of the Software, and
to permit persons to whom the Software is furnished to do so, subject to
the following conditions:
.PP
The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.
.PP
THE SOFTWARE IS PROVIDED \[lq]AS IS\[rq], WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
.SH BUGS
.IP \[bu] 2
There is currently not a timestamp function for updating output files.
.IP \[bu] 2
Although this is most likely to be used on GNU/Linux clusters running a
BigData Platform (e.g Apache Hadoop, \c
.UR https://hadoop.apache.org
.UE \c
), current development is on macOS Sonoma (Darwin 23.3.0) with XCode and
the LLVM CLang compiler.
Porting it to other platforms should be relatively easy.
.PP
Submit bug reports online at: \c
.UR https://github.com/ASCCON/DStat/issues
.UE \c
.SH SEE ALSO
Full documentation and sources at: \c
.UR https://github.com/ASCCON/DStat
.UE \c
